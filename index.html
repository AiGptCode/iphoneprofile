<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Configuration Profile Generator</title>
  <!-- Add Bootstrap CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Add custom CSS styles -->
  <style>
    /* Add your custom CSS styles here */
  </style>
  <!-- Add custom fonts from Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
</head>
<body>
  <div class="container">
    <h1>Configuration Profile Generator</h1>
    <!-- Add form for configuration generator -->
    <form id="config-form">
      <!-- APN -->
      <div class="mb-3">
        <label for="apn" class="form-label">APN:</label>
        <select id="apn" class="form-select">
          <option value="mcinet">MCI</option>
          <option value="irancell">Irancell</option>
          <option value="rightel">RighTel</option>
        </select>
        <div class="form-text">Select the APN (Access Point Name) for your carrier. The default option is "MCI".</div>
      </div>

      <button type="submit" class="btn btn-primary">Generate Configuration Profile</button>
    </form>
  </div>

  <!-- Add Bootstrap JS CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>

  <!-- Add plist.js library -->
  <script src="https://unpkg.com/plist@3.0.2/build/plist.min.js"></script>

  <!-- Add custom JavaScript -->
  <script>
    const configForm = document.getElementById('config-form');

    function generateUniqueUUID() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
    }

    function handleFormSubmit(event) {
      event.preventDefault();

      // Collect form data
      const apn = document.getElementById('apn').value;

      // Create the configuration profile dictionary
      const configDict = {
        "PayloadContent": [
          {
            "PayloadDisplayName": "Cellular",
            "PayloadIdentifier": "com.apple.cellular",
            "PayloadType": "com.apple.cellular",
            "PayloadUUID": generateUniqueUUID(),
            "PayloadVersion": 1,
            "APNs": [
              {
                "AuthenticationType": "CHAP",
                "Enabled": true,
                "Name": apn
              }
            ],
            "SignalBoostEnabled": true,
            "Proxy": {
              "Enabled": true,
              "PayloadType": "com.apple.proxy",
              "PayloadUUID": generateUniqueUUID(),
              "PayloadVersion": 1,
              "HTTPEnable": true,
              "HTTPPort": 8080,
              "HTTPSEnable": true,
              "HTTPSPort": 8080,
              "FTPEnable": true,
              "FTPPort": 21,
              "SOCKSEnable": true,
              "SOCKSPort": 1080,
              "Server": "proxy.example.com",
              "ExclusionList": [
                "localhost",
                "127.0.0.1",
                "169.254.0.0/16"
              ]
            }
          }
        ],
        "PayloadDisplayName": "Cellular and Network Settings",
        "PayloadIdentifier": "com.example.cellular",
        "PayloadOrganization": "Example Inc.",
        "PayloadRemovalDisallowed": false,
        "PayloadType": "Configuration",
        "PayloadUUID":

generateUniqueUUID(),
"PayloadVersion": 1
};

// Convert the configuration dictionary to a plist string
const configPlist = plist.build(configDict);

// Create a Blob object from the configuration plist string
const configBlob = new Blob([configPlist], { type: 'application/x-apple-configurator' });

// Create a download link and click it to download the file
const downloadLink = document.createElement('a');
downloadLink.href = URL.createObjectURL(configBlob);
downloadLink.download = 'config.mobileconfig';
downloadLink.click();

// Wait for the download to complete before revoking the object URL
setTimeout(() => {
URL.revokeObjectURL(downloadLink.href);
}, 1000);
}

configForm.addEventListener('submit', handleFormSubmit);

</script>
</body>
</html>
